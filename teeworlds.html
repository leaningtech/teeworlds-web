<!DOCTYPE html>
<html lang="en" style="height:100%;">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no,initial-scale=1.0,maximum-scale=1.0,minimal-ui" />
    <link rel="icon" type="image/png" href=".icon.png">
    <title>TeeWorlds - Web edition</title>
    <style>
      #gamecanvas {
        margin:0;
        display:block;
        -ms-touch-action:none;
        touch-action:none;
        -ms-content-zooming:none;
        content-zooming:none;
        width:100%;
        height:100%;
      }
      #overlay {
        position:fixed;
        background:rgba(0,0,0,0.8);
        top:0;
        bottom:0;
        right:0;
        left:0;
        display:flex;
        flex-direction: column;
        justify-content:center;
        align-items:center;
        color:white;
        font-size:32px;
      }
      #overlay > p {
        font-size: 16px;
      }
      #overlay > h2 {
        font-size: 32px;
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body style="height:100%;margin:0;">
  <canvas id="gamecanvas" width="800" height="600">
  </canvas>
  <div id="overlay" ></div>
  <script>
    let canvas = document.getElementById("gamecanvas");
    let overlay = document.getElementById("overlay");
    let rect = canvas.getBoundingClientRect();
    canvas.style.height = rect.height+"px";
    canvas.style.width = rect.width+"px";

    function startLoadingScreen()
    {
      overlay.innerText = "Loading..."
    }
    function updateLoadingScreen(perc)
    {
      overlay.innerText = "Loading "+(perc|0)+"%"
    }
    function endLoadingScreen()
    {
      overlay.innerHTML = `
        <h2>Default Controls</h2>
        <p>Move Left/Right: a / d</p>
        <p>Jump: Space</p>
        <p>Fire: Mouse1</p>
        <p>Hook: Mouse2</p>
        <p>Switch Weapon: Mouse Wheel / 1-5</p>
        <p>Chat: t</p>
        <p>Scoreboard: TAB</p>
        <p>Back/Menu: F12</p>
        <h1> Click to Play</h1>
      `;
    }
    function loadGame()
    {
      let script = document.createElement("script");
      script.src = "teeworlds.js";
      document.body.appendChild(script);
    }
    function start()
    {
      startLoadingScreen();
      // Basic detection of mobile browsers, add a button to play anyway to deal with false positives
      let isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
      if(isMobile)
      {
        overlay.innerHTML = "<h2>Sorry!</h2><p>This game requires a mouse, so it only works on desktop browsers</p><p><button onclick='loadGame()'>Play anyway</button></p>"
      }
      else
      {
        loadGame();
      }
    }
    start();
  </script>
  <script src="https://www.gstatic.com/firebasejs/5.0.4/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.0.4/firebase-database.js"></script>
  </body>
</html>
